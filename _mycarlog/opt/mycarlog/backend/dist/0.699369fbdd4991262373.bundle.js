/*!
 * 
 * [Dojo](https://dojo.io/)
 * Copyright [JS Foundation](https://js.foundation/) & contributors
 * [New BSD license](https://github.com/dojo/meta/blob/master/LICENSE)
 * All rights reserved
 * 
 */
(window.dojoWebpackJsonputomotive_og=window.dojoWebpackJsonputomotive_og||[]).push([[0],{22:function(e,t,s){"use strict";s.d(t,"a",function(){return o});var a=s(0);s(1);function o(e,t=!1,s=!1){return s?a.default[e].bind(a.default):a.default[e]}},260:function(e,t,s){"use strict";s.r(t),s.d(t,"default",function(){return g});var a=s(36),o=s(18),i=s(19),n=s(28),l=s(48),r=s(72),c=s(71),d=s(84),h=s(35),u=s(37),p=s(33),_=s(44),b=s(76),m=s(38);class g extends i.b{constructor(){super(...arguments),this.Params={idfueling:"0",rowkey:0,date_reg:"2020-01-01",idvehicle:"0",iduser:"0",odometer:0,quantity:0,idfueltype:"0",price_by_unit:"0",total:0,full_tank:!1,geox:0,geoy:0,address:"",last_lost:!1,note:""},this._openAddress=!1,this._openSnack=!1,this._MsgSnackBar="-"}SnackBar(e){this._openSnack=!0,this._MsgSnackBar=e,this.invalidate(),setTimeout(()=>{this._openSnack=!1,this.invalidate()},4e3)}async GetAddress(){let e=`[out:json][timeout:10];is_in(${this.Params.geox},${this.Params.geoy})->.a;relation(pivot.a);out tags qt;(way(around:20,${this.Params.geox},${this.Params.geoy}););out tags qt;`,t=await fetch("https://overpass-api.de/api/interpreter",{credentials:"omit",headers:{accept:"*/*","accept-language":"es-ES,es;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"cross-site"},referrer:`https://www.openstreetmap.org/query?lat=${this.Params.geox}&lon=${this.Params.geoy}`,referrerPolicy:"no-referrer-when-downgrade",body:e,method:"POST",mode:"cors"}),s=await t.json();console.log(s);var a="";s.elements&&s.elements.forEach((e,t)=>{e.tags&&(0==t?a+=e.tags.name:!e.tags.timezone&&e.tags.name&&(a+=", "+e.tags.name)),s.elements.length==t+1&&(this.Params.address=a,this.invalidate(),this.SnackBar(a))})}Save(){console.log(this.Params),this.Params.odometer>0&&Number(this.Params.idvehicle)>0?fetch("/fueling",{method:"POST",body:JSON.stringify(this.Params),headers:{"Content-Type":"application/json"}}).then(e=>{e.json().then(e=>{e.save?window.location.href="/#fuelinglog":(this.SnackBar("No se pudo guardar"),this.invalidate())})}):this.SnackBar("Complete los campos requerido"),this.invalidate()}async onAttach(){if(this.properties.idfueling){var e=window.location.hash.split("?")[1],t=new URLSearchParams(e);this.Params.idfueling=t.get("idfueling")||"-3";var s="/fueling?idfueling="+this.Params.idfueling;const a=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"}});if(200==a.status){let e=await a.json();e.length>0&&(this.Params=e[0])}console.log(a),this.invalidate()}}getLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{this.Params.geox=e.coords.latitude,this.Params.geoy=e.coords.longitude,this.invalidate(),this.Params.address.length<2&&this.GetAddress().then()}):this.SnackBar("No se pudo obtener las coordenadas")}render(){return Object(o.j)("div",{},[Object(o.k)(m.a,{}),Object(o.k)(u.a,{heading:"ABASTECIMIENTO",collapseWidth:150},[Object(o.k)(p.a,{label:"HISTORIAL",classes:["fas","fa-table"],ShowLabel:!0,onClick:e=>{if(console.log("Historial ",this.Params),Number(this.Params.idvehicle)>0){let e="/#fuelinglog?idvehicle="+this.Params.idvehicle;console.log(e),window.location.href=e}else this.SnackBar("Seleccione un vehículo")}}),Object(o.j)("span",{},["|"]),Object(o.k)(p.a,{label:"GUARDAR",classes:["fas","fa-save"],ShowLabel:!0,onClick:e=>{this.Save()}})]),Object(o.j)("div",{classes:n.field_one_line},[Object(o.k)(d.a,{label:"Vehículo",value:this.Params.idvehicle,url:"/toselect/vehicles",onSelect:(e,t,s)=>{console.log("onSelect",e,t,s),this.Params.idvehicle=t},params:{idaccount:localStorage.getItem("idaccount")}})]),Object(o.j)("div",{classes:n.row},[Object(o.j)("div",{classes:[n.column2]},[Object(o.k)(l.a,{type:"text",label:"Odómetro (Km)",disabled:!1,readOnly:!1,required:!0,value:this.Params.odometer,onChange:e=>{this.Params.odometer=Number(e),this.invalidate()}})]),Object(o.j)("div",{classes:n.column2_center_checkbox},[Object(o.k)(r.b,{checked:this.Params.full_tank,aria:{describedBy:"Tanque lleno"},label:"Tanque lleno",name:"full_tank",onLabel:"Si",offLabel:"No",onChange:(e,t)=>{this.Params.full_tank=t,console.log(this.Params.full_tank),this.invalidate()}})])]),Object(o.j)("div",{classes:n.row},[Object(o.j)("div",{classes:[n.column2]},[Object(o.k)(l.a,{type:"text",label:"Cantidad",disabled:!1,readOnly:!1,required:!0,value:this.Params.quantity,onChange:e=>{this.Params.quantity=Number(e),this.invalidate()}})]),Object(o.j)("div",{classes:[n.column2]},[Object(o.k)(d.a,{label:"Tipo Combustible",value:this.Params.idfueltype,url:"/toselect/fueltypes",onSelect:(e,t,s)=>{console.log("onSelect",e,t,s),this.Params.idfueltype=t}})])]),Object(o.j)("div",{classes:n.row},[Object(o.j)("div",{classes:[n.column2]},[Object(o.k)(l.a,{type:"number",label:"Precio x Unidad",disabled:!1,readOnly:!1,value:this.Params.price_by_unit,onChange:e=>{this.Params.price_by_unit=e,this.invalidate()}})]),Object(o.j)("div",{classes:[n.column2]},[Object(o.k)(l.a,{type:"number",label:"Costo Total",disabled:!1,readOnly:!1,value:this.Params.total,onChange:e=>{this.Params.total=Number(e),this.invalidate()}})])]),Object(o.j)("div",{classes:n.row},[Object(o.j)("div",{classes:[n.column2]},[Object(o.k)(l.a,{type:"date",label:"Fecha",disabled:!1,readOnly:!1,required:!0,placeholder:"Fecha",value:this.Params.date_reg,onChange:e=>{this.Params.date_reg=e,this.invalidate()}})]),Object(o.j)("div",{classes:[n.column2]},[Object(o.k)(l.a,{type:"text",label:"Hora",disabled:!1,readOnly:!1,required:!0,placeholder:"Hora",value:this.Params.date_reg,onChange:e=>{this.Params.date_reg=e,this.invalidate()}})])]),Object(o.j)("div",{classes:n.field_one_line},[Object(o.k)(b.a,{title:"Punto de abastecimiento",open:this._openAddress,onRequestOpen:()=>{this._openAddress=!0,this.getLocation(),console.log("Abrió pane")},onRequestClose:()=>{this._openAddress=!1,console.log("Cerró pane")}},[Object(o.j)("div",{classes:n.row},[Object(o.j)("div",{classes:[n.column2]},[Object(o.k)(l.a,{type:"number",label:"Coordenada X",disabled:!1,readOnly:!1,value:this.Params.geox,onChange:e=>{this.Params.geox=e,this.invalidate()}})]),Object(o.j)("div",{classes:[n.column2]},[Object(o.k)(l.a,{type:"number",label:"Coordenada Y",disabled:!1,readOnly:!1,value:this.Params.geoy,onChange:e=>{this.Params.geoy=e,this.invalidate()}})]),Object(o.j)("div",{classes:[n.field_one_line]},[Object(o.k)(c.a,{columns:40,rows:5,placeholder:"Dirección",label:"Dirección",key:"text-area",value:this.Params.address,onInput:e=>{this.Params.address=e,this.invalidate()}})])])])]),Object(o.j)("div",{classes:n.row},[Object(o.j)("div",{classes:n.column2_center_checkbox},[Object(o.k)(r.b,{checked:this.Params.last_lost,aria:{describedBy:"Última recarga perdida"},label:"Última recarga perdida",name:"last_lost",onLabel:"Si",offLabel:"No",onChange:(e,t)=>{this.Params.last_lost=t,console.log(this.Params.last_lost),this.invalidate()}})]),Object(o.j)("div",{classes:n.column2},[])]),Object(o.j)("div",{classes:[n.field_one_line]},[Object(o.k)(c.a,{columns:40,rows:5,placeholder:"Notas",label:"Notas",key:"text-area",value:this.Params.note,onInput:e=>{this.Params.note=e,this.invalidate()}})]),Object(o.k)(_.a,{open:this._openSnack,leading:!1,type:"error",messageRenderer:()=>this._MsgSnackBar})])}}Object(a.a)([Object(h.a)()],g.prototype,"Params",void 0),Object(a.a)([Object(h.a)()],g.prototype,"_openAddress",void 0),Object(a.a)([Object(h.a)()],g.prototype,"_openSnack",void 0),Object(a.a)([Object(h.a)()],g.prototype,"_MsgSnackBar",void 0)},72:function(e,t,s){"use strict";s.d(t,"a",function(){return a});var a,o=s(20),i=s(19),n=s(21),l=s(29),r=s(43),c=s(49),d=s(27),h=s(18),u=s(24),p=s(73);!function(e){e.normal="normal",e.toggle="toggle"}(a||(a={}));let _=class extends(Object(n.c)(Object(l.a)(i.a))){constructor(){super(...arguments),this._uuid=Object(u.c)()}_onBlur(e){const t=e.target;this.properties.onBlur&&this.properties.onBlur(t.value,t.checked)}_onChange(e){e.stopPropagation();const t=e.target;this.properties.onChange&&this.properties.onChange(t.value,t.checked)}_onClick(e){e.stopPropagation();const t=e.target;this.properties.onClick&&this.properties.onClick(t.value,t.checked)}_onFocus(e){const t=e.target;this.properties.onFocus&&this.properties.onFocus(t.value,t.checked)}_onMouseDown(e){e.stopPropagation(),this.properties.onMouseDown&&this.properties.onMouseDown()}_onMouseUp(e){e.stopPropagation(),this.properties.onMouseUp&&this.properties.onMouseUp()}_onTouchStart(e){e.stopPropagation(),this.properties.onTouchStart&&this.properties.onTouchStart()}_onTouchEnd(e){e.stopPropagation(),this.properties.onTouchEnd&&this.properties.onTouchEnd()}_onTouchCancel(e){e.stopPropagation(),this.properties.onTouchCancel&&this.properties.onTouchCancel()}getRootClasses(){const{checked:e=!1,disabled:t,invalid:s,mode:o,readOnly:i,required:n}=this.properties,l=this.meta(r.a).get("root");return[p.root,o===a.toggle?p.toggle:null,e?p.checked:null,t?p.disabled:null,l.containsFocus?p.focused:null,!0===s?p.invalid:null,!1===s?p.valid:null,i?p.readonly:null,n?p.required:null]}renderToggle(){const{checked:e,mode:t,onLabel:s,offLabel:o}=this.properties;return t===a.toggle?[o?Object(h.j)("div",{key:"offLabel",classes:this.theme(p.offLabel),"aria-hidden":e?"true":null},[o]):null,Object(h.j)("div",{key:"toggle",classes:this.theme(p.toggleSwitch)}),s?Object(h.j)("div",{key:"onLabel",classes:this.theme(p.onLabel),"aria-hidden":e?null:"true"},[s]):null]:[]}render(){const{aria:e={},classes:t,checked:s=!1,disabled:a,widgetId:o=this._uuid,invalid:i,label:n,labelAfter:l=!0,labelHidden:u,theme:_,name:b,readOnly:m,required:g,value:j}=this.properties,v=this.meta(r.a).get("root"),k=[Object(h.j)("div",{classes:this.theme(p.inputWrapper)},[...this.renderToggle(),Object(h.j)("input",Object.assign({id:o},Object(d.b)(e),{classes:this.theme(p.input),checked:s,disabled:a,focus:this.shouldFocus,"aria-invalid":!0===i?"true":null,name:b,readOnly:m,"aria-readonly":!0===m?"true":null,required:g,type:"checkbox",value:j,onblur:this._onBlur,onchange:this._onChange,onclick:this._onClick,onfocus:this._onFocus,onmousedown:this._onMouseDown,onmouseup:this._onMouseUp,ontouchstart:this._onTouchStart,ontouchend:this._onTouchEnd,ontouchcancel:this._onTouchCancel}))]),n?Object(h.k)(c.a,{key:"label",classes:t,theme:_,disabled:a,focused:v.containsFocus,invalid:i,readOnly:m,required:g,hidden:u,forId:o,secondary:!0},[n]):null];return Object(h.j)("div",{key:"root",classes:this.theme(this.getRootClasses())},l?k:k.reverse())}};_=o.__decorate([Object(n.f)(p)],_),t.b=_},73:function(e,t,s){s(74),e.exports={" _key":"@dojo/widgets/checkbox",root:"checkbox-m__root__306Hj",input:"checkbox-m__input__2c32X",inputWrapper:"checkbox-m__inputWrapper__18x6Q",checked:"checkbox-m__checked__3Mh6h",disabled:"checkbox-m__disabled__OQT1C",focused:"checkbox-m__focused__35iMF",readonly:"checkbox-m__readonly__jOqIs",required:"checkbox-m__required__g1cWt",invalid:"checkbox-m__invalid__FhP_j",valid:"checkbox-m__valid__19doN",toggle:"checkbox-m__toggle__3gWDr",onLabel:"checkbox-m__onLabel__1ISHp",offLabel:"checkbox-m__offLabel__1gBqt",toggleSwitch:"checkbox-m__toggleSwitch__cSjeF"}},74:function(e,t,s){},76:function(e,t,s){"use strict";var a=s(20),o=s(24),i=s(21),n=s(29),l=s(18),r=s(19),c=s(34),d=s(77),h=s(80),u=s(47),p=s(69);let _=class extends(Object(i.c)(Object(n.a)(r.a))){constructor(){super(...arguments),this._id=Object(o.c)(),this._onWindowResize=(()=>{this.invalidate()})}_onTitleClick(e){e.stopPropagation(),this._toggle()}_toggle(){const{closeable:e=!0,key:t,onRequestClose:s,onRequestOpen:a,open:o=!0}=this.properties;e&&(o?s&&s(t):a&&a(t))}getButtonContent(){return this.properties.title}getFixedModifierClasses(){const{closeable:e=!0}=this.properties;return[e?d.closeableFixed:null]}getModifierClasses(){const{closeable:e=!0}=this.properties;return[e?h.closeable:null]}getPaneContent(){return this.children}renderExpandIcon(){const{open:e=!0,theme:t,classes:s}=this.properties;return Object(l.j)("span",{classes:this.theme(h.arrow)},[Object(l.k)(c.a,{type:e?"downIcon":"rightIcon",theme:t,classes:s})])}getPaneStyles(){const{open:e=!0}=this.properties,t=this.meta(u.a).get("content");return{marginTop:e?"0px":`-${t.offset.height}px`}}render(){const{closeable:e=!0,headingLevel:t,open:s=!0}=this.properties;let a=!1;return s!==this._open&&(a=!0,this._open=s),Object(l.j)("div",{classes:[...this.theme([h.root,s?h.open:null]),d.rootFixed]},[Object(l.k)(p.b,{key:"global",window:{resize:this._onWindowResize}}),Object(l.j)("div",{"aria-level":t?`${t}`:null,classes:[...this.theme([h.title,...this.getModifierClasses()]),d.titleFixed,...this.getFixedModifierClasses()],role:"heading"},[Object(l.j)("button",{"aria-controls":`${this._id}-content`,"aria-expanded":`${s}`,disabled:!e,classes:[d.titleButtonFixed,...this.theme([h.titleButton])],focus:this.shouldFocus,id:`${this._id}-title`,type:"button",onclick:this._onTitleClick},[this.renderExpandIcon(),this.getButtonContent()])]),Object(l.j)("div",{"aria-hidden":s?null:"true","aria-labelledby":`${this._id}-title`,classes:[...this.theme([h.content,a?h.contentTransition:null]),d.contentFixed],id:`${this._id}-content`,key:"content",styles:this.getPaneStyles()},this.getPaneContent())])}};_=a.__decorate([Object(i.f)(h)],_),t.a=_},77:function(e,t,s){s(78),e.exports={" _key":"@dojo/widgets/title-pane",rootFixed:"title-pane-m__rootFixed__oPswN",titleFixed:"title-pane-m__titleFixed__1-iVY",titleButtonFixed:"title-pane-m__titleButtonFixed__3JEqs",contentFixed:"title-pane-m__contentFixed__3kE1q",closeableFixed:"title-pane-m__closeableFixed__x4J9P"}},78:function(e,t,s){},80:function(e,t,s){s(81),e.exports={" _key":"@dojo/widgets/title-pane",title:"title-pane-m__title__1gwpz",closeable:"title-pane-m__closeable__2H5fz",arrow:"title-pane-m__arrow__3mO_t",root:"title-pane-m__root__3J-5z",open:"title-pane-m__open__1bhv7",content:"title-pane-m__content__bQNuo",titleButton:"title-pane-m__titleButton__1NKNS",contentTransition:"title-pane-m__contentTransition__2SrMd"}},81:function(e,t,s){}}]);
//# sourceMappingURL=0.699369fbdd4991262373.bundle.js.map