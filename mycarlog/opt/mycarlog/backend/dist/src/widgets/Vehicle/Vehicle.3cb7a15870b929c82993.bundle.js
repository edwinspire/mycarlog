/*!
 * 
 * [Dojo](https://dojo.io/)
 * Copyright [JS Foundation](https://js.foundation/) & contributors
 * [New BSD license](https://github.com/dojo/meta/blob/master/LICENSE)
 * All rights reserved
 * 
 */
(window.dojoWebpackJsonpmycarlog3=window.dojoWebpackJsonpmycarlog3||[]).push([["src/widgets/Vehicle/Vehicle"],{275:function(e,s,t){e.exports={" _key":"mycarlog3/Vehicle",spacing:"Vehicle-m__spacing__e9fe791z0jY"}},277:function(e,s,t){e.exports={" _key":"mycarlog3/SelectRemoteSource",full_width:"SelectRemoteSource-m__full_width__e9fe791RePL"}},311:function(e,s,t){"use strict";t.r(s);var a=t(32),i=t(20),l=t(21),o=t(275);class c extends l.a{render(){return Object(i.k)("span",{},[Object(i.k)("div",{classes:["field"]},[Object(i.k)("label",{classes:["label","is-small"]},[this.properties.label]),Object(i.k)("div",{classes:["control"]},[Object(i.k)("textarea",{rows:this.properties.rows,cols:this.properties.cols,required:this.properties.required,placeholder:this.properties.placeholder,classes:["textarea","is-small"],value:this.properties.value,onchange:e=>{this.properties.onValue&&this.properties.onValue(e.target.value),console.log("Click")}},[this.properties.value])])])])}}var r=t(277);class n extends l.a{constructor(){super(...arguments),this.RemoteOptions=[],this.Options=[]}async onAttach(){try{let e=await fetch(this.properties.url,{method:"POST",body:JSON.stringify(this.properties.params),headers:{"Content-Type":"application/json"}});if(200==e.status){let s=await e.json();this.RemoteOptions=s,this.Options=[],await this.RemoteOptions.forEach((e,s)=>{this.Options.push(Object(i.k)("option",{value:e.value},[e.label])),this.invalidate()}),console.log("Opciones",this.Options.length)}else 401==e.status&&(window.location.href="/#login")}catch(e){console.log(e),this.invalidate()}}render(){return Object(i.k)("span",{},[Object(i.k)("div",{classes:["field"]},[Object(i.k)("label",{classes:["label","is-small"]},[this.properties.label]),Object(i.k)("div",{classes:["control","is-small"]},[Object(i.k)("div",{classes:["select is-small",r.full_width]},[Object(i.k)("select",{required:this.properties.required,onchange:e=>{this.properties.onValue&&this.properties.onValue(e.target.value),console.log("Click",e.target,e)}},this.Options)])])])])}}var d=t(34),h=t(35);class u extends l.a{render(){return Object(i.k)("span",{},[Object(i.k)("div",{classes:["field"]},[Object(i.k)("label",{classes:["label","is-small"]},[this.properties.label]),Object(i.k)("div",{classes:["control","is-small"]},[Object(i.k)("input",{max:this.properties.max,min:this.properties.min,required:this.properties.required,value:this.properties.value,placeholder:this.properties.placeholder||"",type:this.properties.type||"text",classes:["input","is-small"],onchange:e=>{console.log(e),this.properties.onValue&&this.properties.onValue(e.target.value)}})])])])}}var p=t(41),m=t(45),b=t(50),v=t(29);function k(e,s=v.a,t){return Object(b.b)((a,i)=>{a.addDecorator(`diffProperty:${e}`,s.bind(null)),a.addDecorator("registeredDiffProperty",e),(t||i)&&a.addDecorator("diffReaction",{propertyName:e,reaction:i?a[i]:t})})}class O extends l.a{constructor(){super(),this.open=!1,k("message",v.a,this.diffFooReaction)(this),console.log("Se ha creado")}diffFooReaction(e,s){console.log(e,s),s.message.length>0&&this.show()}show(){this.open=!0,this.invalidate(),setTimeout(()=>{this.open=!1,this.invalidate()},5e3)}render(){return Object(i.l)(m.a,{open:this.open,type:this.properties.type},[{message:this.properties.message}])}}t.d(s,"default",function(){return j});class j extends l.a{constructor(){super(...arguments),this.Params={idvehicle:"-1",idaccount:0,idcontact:"0",rowkey:0,license_plate:"",year:"0",fuel_tank_capacity:"0",idfuel_tank_capacitytype:"0",vin:"",idvehicletype:"0",idmark:"0",model:"",color:"0",idfueltype:"0",idunit_measure_fuel_tank:"0",note:""},this.Message="",this.MessageType=void 0}SnackBar(e,s){this.MessageType=s,this.Message=e}async Save(){if(console.log(this.Params),this.Params.idaccount&&this.Params.idaccount>0)if(Number(this.Params.idcontact)>0)if(this.Params.license_plate.length>0){let e=await fetch("/vehicle_cu",{method:"POST",body:JSON.stringify(this.Params),headers:{"Content-Type":"application/json"}}),s=await e.json();200==e.status?(console.log(s),s.idvehicle>0?(this.SnackBar("Guardado","success"),setTimeout(()=>{window.location.href="/#vehicle_cards?idvehicle="+s.idvehicle+"&idaccount="+this.Params.idaccount},2e3)):this.SnackBar("No se pudo guardar","error")):401==e.status?window.location.href="/#login":this.SnackBar("No se pudo guardar "+e.status,"error")}else this.SnackBar("Complete los campos que son requeridos","error");else this.SnackBar("Debe seleccionar un Propietario","error");else this.SnackBar("No se encuentra una cuenta válida","error");this.invalidate()}async onAttach(){if(console.log(this.properties.idvehicle),this.Params.idaccount=window.GlobalStore.get(window.GlobalStore.path("root","user","idaccount")),this.properties.idvehicle){var e=window.location.hash.split("?")[1],s=new URLSearchParams(e);this.Params.idvehicle=s.get("idvehicle")||"-2";var t="/vehicle?idvehicle="+this.Params.idvehicle+"&idaccount="+this.Params.idaccount;const a=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}});let i=await a.json();console.log(i),i.length>0&&i[0].idaccount&&i[0].idvehicle&&(this.Params=i[0],this.invalidate())}}render(){return Object(i.k)("div",{},[Object(i.l)(O,{message:this.Message,type:this.MessageType}),Object(i.l)(h.a,{}),Object(i.l)(p.a,{title:"VEHÍCULO",ShowNew:!0,ShowSave:!0,onSave:()=>{this.Save()},onNew:()=>{this.Params={idaccount:this.Params.idaccount,idvehicle:"-1",idcontact:"0",rowkey:0,license_plate:"",year:"0",fuel_tank_capacity:"0",idfuel_tank_capacitytype:"0",vin:"",idvehicletype:"0",idmark:"0",model:"",color:"",idfueltype:"0",idunit_measure_fuel_tank:"0",note:""}}}),Object(i.k)("div",{classes:[]},[Object(i.k)("div",{classes:["columns is-mobile",o.spacing]},[Object(i.k)("div",{classes:["column"]},[Object(i.l)(n,{label:"Propietario",url:"/toselect/contacts",onValue:e=>{console.log("onSelect",e),this.Params.idcontact=e}})]),Object(i.k)("div",{classes:["column"]},[Object(i.l)(u,{label:"Placa",onValue:e=>{this.Params.license_plate=e,this.invalidate()}})])]),Object(i.k)("div",{classes:["columns is-mobile",o.spacing]},[Object(i.k)("div",{classes:["column"]},[Object(i.l)(n,{label:"Marca",value:this.Params.idmark,url:"/toselect/marks",onValue:e=>{console.log("onSelect",e),this.Params.idmark=e}})]),Object(i.k)("div",{classes:["column"]},[Object(i.l)(u,{label:"Modelo",value:this.Params.model,onValue:e=>{this.Params.model=e}},[])])]),Object(i.k)("div",{classes:["columns is-mobile",o.spacing]},[Object(i.k)("div",{classes:["column"]},[Object(i.l)(u,{label:"Año",type:"number",value:this.Params.year,onValue:e=>{this.Params.year=e,this.invalidate()}})]),Object(i.k)("div",{classes:["column"]},[Object(i.l)(u,{label:"VIN",value:this.Params.vin,onValue:e=>{this.Params.vin=e,this.invalidate()}})])]),Object(i.k)("div",{classes:["columns is-mobile",o.spacing]},[Object(i.k)("div",{classes:["column"]},[Object(i.l)(u,{label:"Color",type:"color",value:this.Params.color,onValue:e=>{this.Params.color=e}})]),Object(i.k)("div",{classes:["column"]},[Object(i.l)(n,{label:"Tipo de combustible",url:"/toselect/fueltypes",value:this.Params.idfueltype,onValue:e=>{console.log("onSelect",e),this.Params.idfueltype=e}})])]),Object(i.k)("div",{classes:["columns is-mobile",o.spacing]},[Object(i.k)("div",{classes:["column"]},[Object(i.l)(u,{label:"Capacidad Tanque",type:"number",value:this.Params.fuel_tank_capacity,onValue:e=>{this.Params.fuel_tank_capacity=e,console.log(this.Params.fuel_tank_capacity),this.invalidate()}})]),Object(i.k)("div",{classes:["column"]},[Object(i.l)(n,{label:"Unidad de medida del tanque",url:"/toselect/unit_measure_fuel_tanks",value:this.Params.idunit_measure_fuel_tank,onValue:e=>{console.log("onSelect",e),this.Params.idunit_measure_fuel_tank=e}},[])])]),Object(i.k)("div",{classes:[o.spacing]},[Object(i.l)(c,{label:"Notas",rows:5,value:this.Params.note,onValue:e=>{this.Params.note=e,this.invalidate()}})])])])}}a.a([Object(d.a)()],j.prototype,"Params",void 0)}}]);
//# sourceMappingURL=Vehicle.3cb7a15870b929c82993.bundle.js.map