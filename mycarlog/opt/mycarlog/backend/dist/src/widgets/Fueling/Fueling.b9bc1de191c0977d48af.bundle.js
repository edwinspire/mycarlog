/*!
 * 
 * [Dojo](https://dojo.io/)
 * Copyright [JS Foundation](https://js.foundation/) & contributors
 * [New BSD license](https://github.com/dojo/meta/blob/master/LICENSE)
 * All rights reserved
 * 
 */
(window.dojoWebpackJsonpmycarlog3=window.dojoWebpackJsonpmycarlog3||[]).push([["src/widgets/Fueling/Fueling"],{24:function(e,t,i){"use strict";var o=i(20),a=i(26),s=i(52);const n=Object(o.a)({coreTheme:a.a});function c(e){return`${e.charAt(0).toUpperCase()}${e.slice(1)}`}function l(e){return e&&e.hasOwnProperty("variant")}const r=n(function({middleware:{coreTheme:e},properties:t}){return Object.assign({compose:(i,o,a)=>{const n=function(){const{theme:i}=t();if(i)return i;const o=e.get();return Object(s.b)(o)?{theme:o.theme,variant:o.variant}:o?o.theme:void 0}(),r=i[" _key"],d=o[" _key"],u=Object.keys(i).reduce((e,t)=>" _key"===t?e:(a&&!e[`${a}${c(t)}`]&&(e[`${a}${c(t)}`]=" "),o[t]||(e[t]=" "),e),{" _key":d}),_=e.classes(u),h=e.classes(o);let m=e.classes(i);if(a){const e=Object.keys(Object.assign({},_,h)).reduce((e,t)=>{if(0===t.indexOf(a)&&t!==a){const i=function(e){return`${e.charAt(0).toLowerCase()}${e.slice(1)}`}(t.replace(a,""));!h[t]&&_[t]&&_[t].trim()&&(e[i]=`${m[i]} ${_[t].trim()}`),h[t]&&(e[i]=h[t])}return e},{});return m=Object.assign({},m,e),l(n)?{theme:{theme:Object.assign({},n.theme.theme,{[r]:m}),variants:n.theme.variants},variant:n.variant}:Object.assign({},n,{[r]:m})}const p=Object.keys(m).reduce((e,t)=>{if(" _key"===t)return e;const i=h[t]&&h[t].trim();return h[t]?e[t]=i:_[t]&&_[t].trim()&&(e[t]=`${e[t]} ${_[t].trim()}`),e},Object.assign({},m));return l(n)?{theme:{theme:Object.assign({},n.theme.theme,{[r]:p}),variants:n.theme.variants},variant:n.variant}:Object.assign({},n,{[r]:p})}},e)});t.a=r},27:function(e,t,i){"use strict";var o;function a(e){return Object.keys(e).reduce((t,i)=>(t[`aria-${i.toLowerCase()}`]=e[i],t),{})}i.d(t,"a",function(){return a}),function(e){e[e.Down=40]="Down",e[e.End=35]="End",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Home=36]="Home",e[e.Left=37]="Left",e[e.PageDown=34]="PageDown",e[e.PageUp=33]="PageUp",e[e.Right=39]="Right",e[e.Space=32]="Space",e[e.Tab=9]="Tab",e[e.Up=38]="Up"}(o||(o={}))},275:function(e,t,i){i(276),e.exports={" _key":"@dojo/widgets/checkbox",root:"checkbox-m__root__1pxWQ",input:"checkbox-m__input__CZJkF",inputWrapper:"checkbox-m__inputWrapper__efIfT",checked:"checkbox-m__checked__2e35U",disabled:"checkbox-m__disabled__2pxrv",focused:"checkbox-m__focused__1qMiJ",readonly:"checkbox-m__readonly__3tnli",required:"checkbox-m__required__1we1M",background:"checkbox-m__background__1mGXN",invalid:"checkbox-m__invalid__3ISg0",valid:"checkbox-m__valid__2whfk"}},276:function(e,t,i){},278:function(e,t,i){i(279),e.exports={" _key":"@dojo/widgets/icon",root:"icon-m__root__1eoV_",medium:"icon-m__medium__3Xwur",large:"icon-m__large__Ml3b4",small:"icon-m__small__2BbOV",icon:"icon-m__icon__UdYI1",clockIcon:"icon-m__clockIcon__3GLpu",downIcon:"icon-m__downIcon__2q5lh",leftIcon:"icon-m__leftIcon__pBWIt",rightIcon:"icon-m__rightIcon__18AW6",closeIcon:"icon-m__closeIcon__21KIr",plusIcon:"icon-m__plusIcon__2b4l_",minusIcon:"icon-m__minusIcon__1DHfu",checkIcon:"icon-m__checkIcon__2D3mV",upIcon:"icon-m__upIcon__2Whg2",upAltIcon:"icon-m__upAltIcon__2GXtu",downAltIcon:"icon-m__downAltIcon__hm7FZ",searchIcon:"icon-m__searchIcon__2HGOw",barsIcon:"icon-m__barsIcon__2e0Qo",settingsIcon:"icon-m__settingsIcon__2-UEA",alertIcon:"icon-m__alertIcon__WjF2F",helpIcon:"icon-m__helpIcon__3c7_4",infoIcon:"icon-m__infoIcon__PXtvl",cancelIcon:"icon-m__cancelIcon__2ey9p",checkedBoxIcon:"icon-m__checkedBoxIcon__TSG-9",phoneIcon:"icon-m__phoneIcon__2BO7g",editIcon:"icon-m__editIcon__3j9QX",dateIcon:"icon-m__dateIcon__3vXGn",linkIcon:"icon-m__linkIcon__314xM",locationIcon:"icon-m__locationIcon__1uwwo",secureIcon:"icon-m__secureIcon__UXrMt",mailIcon:"icon-m__mailIcon__3uh6Q",eyeIcon:"icon-m__eyeIcon__2Cqqq",eyeSlashIcon:"icon-m__eyeSlashIcon__17wRy",starIcon:"icon-m__starIcon__r0lYz"}},279:function(e,t,i){},281:function(e,t,i){i(282),e.exports={" _key":"@dojo/widgets/title-pane",title:"title-pane-m__title__3tf5J",closeable:"title-pane-m__closeable__3zOGh",arrow:"title-pane-m__arrow__3vShr",root:"title-pane-m__root__1sOUk",open:"title-pane-m__open__2g2VL",content:"title-pane-m__content__zjzP2",titleButton:"title-pane-m__titleButton__1PgVR",contentTransition:"title-pane-m__contentTransition__1vxdJ"}},282:function(e,t,i){},284:function(e,t,i){i(285),e.exports={" _key":"@dojo/widgets/title-pane",rootFixed:"title-pane-m__rootFixed__oPswN",titleFixed:"title-pane-m__titleFixed__1-iVY",titleButtonFixed:"title-pane-m__titleButtonFixed__3JEqs",contentFixed:"title-pane-m__contentFixed__3kE1q",closeableFixed:"title-pane-m__closeableFixed__x4J9P"}},285:function(e,t,i){},287:function(e,t,i){e.exports={" _key":"mycarlog3/Fueling",spacing:"Fueling-m__spacing__e9fe792WkHZ"}},312:function(e,t,i){"use strict";i.r(t);var o=i(32),a=i(20),s=i(21),n=i(41),c=i(34),l=i(43),r=i(35),d=i(26);Array.prototype.slice,Object.prototype.hasOwnProperty;var u=i(27),_=i(46),h=i(275);var m=Object(a.a)({theme:d.a,focus:r.a}).properties().children()(function({children:e,properties:t,middleware:{theme:i,focus:o}}){const s="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),{aria:n={},checked:c=!1,classes:l,disabled:r,labelHidden:d,name:m,onBlur:p,onFocus:b,onValue:g,onOut:f,onOver:v,readOnly:O,required:j,theme:y,valid:k,value:x,widgetId:w=s}=t(),[P]=e(),I=i.classes(h);return Object(a.j)("div",{key:"root",classes:[i.variant(),I.root,c?I.checked:null,r?I.disabled:null,o.isFocused("root")?I.focused:null,!1===k?I.invalid:null,!0===k?I.valid:null,O?I.readonly:null,j?I.required:null]},Object(a.j)("div",{classes:I.inputWrapper},Object(a.j)("input",Object.assign({id:w},Object(u.a)(n),{classes:I.input,checked:c,disabled:r,focus:o.shouldFocus(),"aria-invalid":!1===k?"true":null,name:m,readonly:O,"aria-readonly":!0===O?"true":null,required:j,type:"checkbox",value:x,onblur:()=>p&&p(),onchange:e=>{e.stopPropagation();const t=e.target;g(t.checked)},onfocus:()=>b&&b(),onpointerenter:()=>v&&v(),onpointerleave:()=>f&&f()})),Object(a.j)("div",{classes:I.background})),P&&Object(a.j)(_.a,{key:"label",classes:l,theme:y,disabled:r,focused:o.isFocused("root"),valid:k,readOnly:O,required:j,hidden:d,forId:w,secondary:!0},P))}),p=i(42),b=i(33);const g=Object(a.a)({node:a.i}),f={height:0,left:0,top:0,width:0},v={height:0,left:0,top:0,width:0},O={bottom:0,left:0,right:0,top:0},j={height:0,left:0,top:0,width:0},y={width:0,height:0};var k=g(({middleware:{node:e}})=>({get(t){const i=e.get(t);if(!i)return{client:Object.assign({},f),offset:Object.assign({},v),position:Object.assign({},O),scroll:Object.assign({},j),size:Object.assign({},y)};const o=i.getBoundingClientRect();return{client:{height:i.clientHeight,left:i.clientLeft,top:i.clientTop,width:i.clientWidth},offset:{height:i.offsetHeight,left:i.offsetLeft,top:i.offsetTop,width:i.offsetWidth},position:{bottom:o.bottom,left:o.left,right:o.right,top:o.top},scroll:{height:i.scrollHeight,left:i.scrollLeft,top:i.scrollTop,width:i.scrollWidth},size:{width:o.width,height:o.height}}}})),x=i(22),w=i(24),P=i(278),I=i(36);var q=Object(a.a)({theme:w.a}).properties()(function({properties:e,middleware:{theme:t}}){const{aria:i={hidden:"true"},type:o,altText:s,size:n}=e(),c=t.classes(P),l=n&&c[n];return Object(a.j)("virtual",null,Object(a.j)("i",Object.assign({classes:[t.variant(),c.icon,c[o],l]},Object(u.a)(i))),s?Object(a.j)("span",{classes:I.visuallyHidden},s):null)}),S=i(281),F=i(284);var T=Object(a.a)({dimensions:k,focus:r.a,icache:Object(x.a)(),theme:w.a}).properties()(function({id:e,children:t,properties:i,middleware:{dimensions:o,focus:s,icache:n,theme:c}}){const l=c.classes(S),{closeable:r=!0,headingLevel:d,initialOpen:u,onClose:_,onOpen:h,name:m,theme:p}=i();let{open:b}=i();const g=void 0===n.get("open");if(void 0===b){b=n.get("open"),u!==n.get("initialOpen")&&(n.set("open",u),n.set("initialOpen",u),b=u)}return Object(a.j)("div",{classes:[c.variant(),l.root,b?l.open:null,F.rootFixed]},Object(a.j)("div",{"aria-level":d?`${d}`:null,classes:[l.title,r?l.closeable:null,F.titleFixed,r?F.closeableFixed:null],role:"heading"},Object(a.j)("button",{"aria-controls":`${e}-content`,"aria-expanded":`${b}`,disabled:!r,classes:[F.titleButtonFixed,l.titleButton],focus:s.isFocused("title-button"),key:"title-button",onclick:e=>{e.stopPropagation(),n.set("open",!b),b?_&&_():h&&h()},type:"button"},Object(a.j)("span",{classes:l.arrow},Object(a.j)(q,{type:b?"downIcon":"rightIcon",theme:p})),m)),Object(a.j)("div",{"aria-hidden":b?null:"true","aria-labelledby":`${e}-title`,classes:[l.content,!g&&l.contentTransition,F.contentFixed],id:`${e}-content`,key:"content",styles:{marginTop:b?"0px":`-${o.get("content").offset.height}px`}},t()))}),V=i(37),$=i(287);i.d(t,"default",function(){return C});class C extends s.a{constructor(){super(...arguments),this.Params={idfueling:"0",rowkey:0,date_reg:"2020-01-01",idvehicle:0,iduser:"0",odometer:0,quantity:0,idfueltype:"0",price_by_unit:"0",total:0,full_tank:!1,geox:0,geoy:0,address:"",last_lost:!1,note:"",idaccount:0},this._openAddress=!1}SnackBar(e){}async GetAddress(){let e=`[out:json][timeout:10];is_in(${this.Params.geox},${this.Params.geoy})->.a;relation(pivot.a);out tags qt;(way(around:20,${this.Params.geox},${this.Params.geoy}););out tags qt;`,t=await fetch("https://overpass-api.de/api/interpreter",{credentials:"omit",headers:{accept:"*/*","accept-language":"es-ES,es;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"cross-site"},referrer:`https://www.openstreetmap.org/query?lat=${this.Params.geox}&lon=${this.Params.geoy}`,referrerPolicy:"no-referrer-when-downgrade",body:e,method:"POST",mode:"cors"}),i=await t.json();console.log(i);var o="";i.elements&&i.elements.forEach((e,t)=>{e.tags&&(0==t?o+=e.tags.name:!e.tags.timezone&&e.tags.name&&(o+=", "+e.tags.name)),i.elements.length==t+1&&(this.Params.address=o,this.invalidate(),this.SnackBar(o))})}async Save(){if(console.log(this.Params),this.Params.odometer>0&&Number(this.Params.idvehicle)>0)try{let e=await fetch("/fueling_cu",{method:"POST",body:JSON.stringify(this.Params),headers:{"Content-Type":"application/json"}}),t=await e.json();t.idfueling&&t.idfueling>0?window.location.href="/#fuelinglog":(this.SnackBar("No se pudo guardar"),this.invalidate())}catch(e){this.SnackBar("No se pudo guardar"),this.invalidate()}else this.SnackBar("Complete los campos requerido");this.invalidate()}async onAttach(){if(this.Params.idaccount=window.GlobalStore.get(window.GlobalStore.path("root","user","idaccount")),this.Params.idvehicle=window.GlobalStore.get(window.GlobalStore.path("root","user","preferences","last_vehicle_selected","idvehicle")),this.properties.idfueling){var e=window.location.hash.split("?")[1],t=new URLSearchParams(e);this.Params.idfueling=t.get("idfueling")||"-3";var i="/fueling?idfueling="+this.Params.idfueling;const o=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json"}});if(200==o.status){let e=await o.json();e.length>0&&(this.Params=e[0])}console.log(o),this.invalidate()}}getLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{this.Params.geox=e.coords.latitude,this.Params.geoy=e.coords.longitude,this.invalidate(),this.Params.address.length<2&&this.GetAddress().then()}):this.SnackBar("No se pudo obtener las coordenadas")}render(){return Object(a.k)("div",{},[Object(a.l)(V.a,{}),Object(a.l)(c.a,{title:"Abastecimiento",ShowSave:!0,onSave:()=>{this.Save()}},[]),Object(a.k)("div",{},[Object(a.k)("div",{classes:["columns is-mobile",$.spacing]},[Object(a.k)("div",{classes:["column"]},[Object(a.l)(m,{checked:this.Params.full_tank,aria:{describedBy:"Tanque lleno"},name:"full_tank",onValue:e=>{this.Params.full_tank=e,console.log(this.Params.full_tank),this.invalidate()}},["Tanque lleno"])]),Object(a.k)("div",{classes:["column"]},[Object(a.l)(n.a,{type:"text",label:"Odómetro",required:!0,value:this.Params.odometer,onValue:e=>{this.Params.odometer=Number(e),this.invalidate()}})])]),Object(a.k)("div",{classes:["columns is-mobile",$.spacing]},[Object(a.k)("div",{classes:["column"]},[Object(a.l)(n.a,{type:"text",label:"quantity",required:!0,value:this.Params.quantity,onValue:e=>{this.Params.quantity=Number(e),this.invalidate()}})]),Object(a.k)("div",{classes:["column"]},[Object(a.l)(l.a,{label:"Tipo Combustible",value:this.Params.idfueltype,url:"/toselect/fueltypes",onValue:e=>{this.Params.idfueltype=e}})])]),Object(a.k)("div",{classes:["columns is-mobile",$.spacing]},[Object(a.k)("div",{classes:["column"]},[Object(a.l)(n.a,{type:"number",label:"Precio x Unidad",value:this.Params.price_by_unit,onValue:e=>{this.Params.price_by_unit=e,this.invalidate()}})]),Object(a.k)("div",{classes:["column"]},[Object(a.l)(n.a,{type:"number",label:"Costo Total",value:this.Params.total,onValue:e=>{this.Params.total=Number(e),this.invalidate()}})])]),Object(a.k)("div",{classes:["columns is-mobile",$.spacing]},[Object(a.k)("div",{classes:["column"]},[Object(a.l)(n.a,{type:"date",label:"Fecha",required:!0,placeholder:"Fecha",value:this.Params.date_reg,onValue:e=>{this.Params.date_reg=e,this.invalidate()}})]),Object(a.k)("div",{classes:["column"]},[Object(a.l)(n.a,{type:"text",label:"Hora",required:!0,placeholder:"Hora",value:this.Params.date_reg,onValue:e=>{this.Params.date_reg=e,this.invalidate()}})])]),Object(a.k)("div",{classes:["columns is-mobile",$.spacing]},[Object(a.k)("div",{classes:["column"]},[Object(a.l)(m,{checked:this.Params.last_lost,aria:{describedBy:"Última recarga perdida"},name:"last_lost",onValue:e=>{this.Params.last_lost=e,console.log(this.Params.last_lost),this.invalidate()}},["Última recarga perdida"])]),Object(a.k)("div",{classes:["column"]},[])]),Object(a.k)("div",{styles:{gridColumnEnd:"span 3"}},[Object(a.l)(T,{name:"Punto de abastecimiento",open:this._openAddress,onOpen:()=>{this._openAddress=!0,this.getLocation(),console.log("Abrió pane")},onClose:()=>{this._openAddress=!1,console.log("Cerró pane")}},[Object(a.k)("div",{},[Object(a.k)("div",{classes:"css.grid2 "},[Object(a.l)(n.a,{type:"number",label:"Coordenada Y",value:this.Params.geoy,onValue:e=>{this.Params.geoy=0,this.invalidate()}}),Object(a.l)(n.a,{type:"number",label:"Coordenada X",value:this.Params.geox,onValue:e=>{this.Params.geox=0,this.invalidate()}}),Object(a.k)("div",{styles:{gridColumnEnd:"span 2"}},[Object(a.l)(p.a,{label:"Dirección",rows:3,placeholder:"Dirección",value:this.Params.address,onValue:e=>{this.Params.address=e,this.invalidate()}})])])])])]),Object(a.k)("div",{classes:[],styles:{gridColumnEnd:"span 3"}},[Object(a.l)(p.a,{rows:5,placeholder:"Notas",label:"Notas",key:"text-area",value:this.Params.note,onValue:e=>{this.Params.note=e,this.invalidate()}})])])])}}o.a([Object(b.a)()],C.prototype,"Params",void 0),o.a([Object(b.a)()],C.prototype,"_openAddress",void 0)},35:function(e,t,i){"use strict";var o=i(0),a=i(20),s=i(22);const n=Object(s.a)(),c=Object(a.a)({icache:n,diffProperty:a.d,node:a.i,destroy:a.c,invalidator:a.f}).properties()(({middleware:{icache:e,diffProperty:t,node:i,destroy:a,invalidator:s}})=>{let n,c=!1,l=0;const r=new Set;function d(){const e=o.default.document.activeElement;(r.has(n)||r.has(e))&&n!==e&&s(),n=e}return t("focus",(t,i)=>{if(i.focus&&i.focus()){const t=e.getOrSet("current",0);e.set("current",t+1)}}),a(()=>{o.default.document.removeEventListener("focusin",d),o.default.document.removeEventListener("focusout",d),r.clear()}),{shouldFocus(){const t=e.get("current")||0,i=t!==l;return l=t,i},focus(){const t=e.getOrSet("current",0);e.set("current",t+1)},isFocused(e){const t=i.get(e);return!!t&&(r.add(t),c||(o.default.document.addEventListener("focusin",d),o.default.document.addEventListener("focusout",d),c=!0),o.default.document.activeElement===t)}}});t.a=c},36:function(e,t,i){i(47),e.exports={" _key":"@dojo/widgets/base",visuallyHidden:"base-m__visuallyHidden__1AeWe",focusable:"base-m__focusable__1_qAN",hidden:"base-m__hidden__3QddU"}},42:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var o=i(20),a=i(21);class s extends a.a{render(){return Object(o.k)("span",{},[Object(o.k)("div",{classes:["field"]},[Object(o.k)("label",{classes:["label","is-small"]},[this.properties.label]),Object(o.k)("div",{classes:["control"]},[Object(o.k)("textarea",{rows:this.properties.rows,cols:this.properties.cols,required:this.properties.required,placeholder:this.properties.placeholder,classes:["textarea","is-small"],value:this.properties.value,onchange:e=>{this.properties.onValue&&this.properties.onValue(e.target.value),console.log("Click")}},[this.properties.value])])])])}}},43:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var o=i(20),a=i(21),s=i(44);class n extends a.a{constructor(){super(...arguments),this.RemoteOptions=[],this.Options=[]}async onAttach(){try{let e=await fetch(this.properties.url,{method:"POST",body:JSON.stringify(this.properties.params),headers:{"Content-Type":"application/json"}});if(200==e.status){let t=await e.json();this.RemoteOptions=t,this.Options=[],await this.RemoteOptions.forEach((e,t)=>{this.Options.push(Object(o.k)("option",{value:e.value},[e.label])),this.invalidate()}),console.log("Opciones",this.Options.length)}else 401==e.status&&(window.location.href="/#login")}catch(e){console.log(e),this.invalidate()}}render(){return Object(o.k)("span",{},[Object(o.k)("div",{classes:["field"]},[Object(o.k)("label",{classes:["label","is-small"]},[this.properties.label]),Object(o.k)("div",{classes:["control","is-small"]},[Object(o.k)("div",{classes:["select is-small",s.full_width]},[Object(o.k)("select",{required:this.properties.required,onchange:e=>{this.properties.onValue&&this.properties.onValue(e.target.value),console.log("Click",e.target,e)}},this.Options)])])])])}}},44:function(e,t,i){e.exports={" _key":"mycarlog3/SelectRemoteSource",full_width:"SelectRemoteSource-m__full_width__e9fe791RePL"}},46:function(e,t,i){"use strict";var o=i(20),a=i(36),s=i(24),n=i(49),c=i(27);const l=Object(o.a)({theme:s.a}).properties()(function({properties:e,id:t,children:i,middleware:{theme:s}}){const{aria:l={},active:r,disabled:d,focused:u,forId:_,hidden:h,readOnly:m,required:p,secondary:b,valid:g,widgetId:f=`label-${t}`}=e(),v=s.classes(n);return Object(o.j)("label",Object.assign({},Object(c.a)(l),{id:f,classes:[s.variant(),v.root,d?v.disabled:null,u?v.focused:null,!0===g?v.valid:null,!1===g?v.invalid:null,m?v.readonly:null,p?v.required:null,b?v.secondary:null,r?v.active:null,h?a.visuallyHidden:null],for:_}),i())});t.a=l},47:function(e,t,i){},49:function(e,t,i){i(50),e.exports={" _key":"@dojo/widgets/label",root:"label-m__root__3Kk7r",readonly:"label-m__readonly__2pxUq",invalid:"label-m__invalid__1CZyi",valid:"label-m__valid__2hdFV",required:"label-m__required__2WVo7",disabled:"label-m__disabled__34MEb",focused:"label-m__focused__ISy0H",secondary:"label-m__secondary__37QWK",active:"label-m__active__3MoIi"}},50:function(e,t,i){}}]);
//# sourceMappingURL=Fueling.b9bc1de191c0977d48af.bundle.js.map