/*!
 * 
 * [Dojo](https://dojo.io/)
 * Copyright [JS Foundation](https://js.foundation/) & contributors
 * [New BSD license](https://github.com/dojo/meta/blob/master/LICENSE)
 * All rights reserved
 * 
 */
(window.dojoWebpackJsonppen_onitoring_ystem=window.dojoWebpackJsonppen_onitoring_ystem||[]).push([[7],{128:function(e,t,a){"use strict";a.d(t,"a",function(){return d});var c=a(33),i=a(18),s=a(19),n=a(22),o=a(23),r=a(32),l=a(40);class d extends s.b{constructor(){super(),this._openSnack=!1,this._MsgSnackBar="",this.SnackBarType="error",Object(o.b)("preference",n.a,this.diffFooReaction)(this)}getLocalUser(){var e={};try{let t=localStorage.getItem("user");if(t){let a=JSON.parse(t);a&&(e=a)}}catch(e){console.error(e)}return console.log(e),e}diffFooReaction(e,t){console.log(t);try{let e=this.getLocalUser();switch(t.preference.name){case"default_idvehicle":e.default_idvehicle=t.preference.value;break;default:if(e&&e.preferences){let a=e.preferences;a[t.preference.name]!=t.preference.value?(a[t.preference.name]=t.preference.value,e.preferences=a,localStorage.setItem("user",JSON.stringify(e)),this.Save()):console.log("No ha cambiado la preferencia")}else this.openSnack("La preferencia "+t.preference.name+" no existe","error")}}catch(e){console.log(e),this.openSnack(e,"error")}}async Save(){var e=this.getLocalUser();if(e.preferences){let t=await fetch("/preferences_u",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}),a=await t.json();console.log(a),a.iduser&&a.rowkey&&(e.rowkey=a.rowkey,localStorage.setItem("user",JSON.stringify(e)))}}openSnack(e,t){this._openSnack=!0,this._MsgSnackBar=e,this.SnackBarType=t,setTimeout(()=>{this._openSnack=!1},4e3)}render(){return Object(i.k)(l.a,{open:this._openSnack,leading:!1,type:this.SnackBarType,messageRenderer:()=>this._MsgSnackBar})}}Object(c.a)([Object(r.a)()],d.prototype,"_openSnack",void 0),Object(c.a)([Object(r.a)()],d.prototype,"_MsgSnackBar",void 0)},323:function(e,t,a){e.exports={" _key":"OpenMonitoringSystem/VehicleCard",container:"VehicleCard-m__container__309e8d3ggyL",column:"VehicleCard-m__column__309e8d2hzND",row:"VehicleCard-m__row__309e8d1cZVt",label:"VehicleCard-m__label__309e8d3hpgA",title:"VehicleCard-m__title__309e8d1zTDQ",image:"VehicleCard-m__image__309e8d1mXtV"}},325:function(e,t,a){a(326),e.exports={" _key":"@dojo/widgets/card",root:"card-m__root__1zMtM",actions:"card-m__actions__1Z_Hb",actionButtons:"card-m__actionButtons__2SSbU",actionIcons:"card-m__actionIcons__3aObP",primaryAction:"card-m__primaryAction__1zj-J",media:"card-m__media__2jfnD",mediaContent:"card-m__mediaContent__2DMyX",mediaSquare:"card-m__mediaSquare__fDbOX",media16by9:"card-m__media16by9__3qldC",primary:"card-m__primary__r84rj",secondary:"card-m__secondary__2FZlH"}},326:function(e,t,a){},333:function(e,t,a){"use strict";a.r(t);var c=a(18),i=a(19),s=a(31),n=a(48),o=a(33),r=a(323),l=a(20),d=a(49),h=a(141);function _(){return Object(d.b)((e,t)=>{Object(h.a)(function(){this.invalidate()})(e)})}var p=a(21),m=a(325);let j=class extends(Object(p.c)(i.a)){render(){const{actionsRenderer:e}=this.properties,t=e&&e();return Object(c.i)("div",{key:"root",classes:this.theme(m.root)},this.children,t&&Object(c.i)("div",{classes:this.theme(m.actions)},t))}};var b=j=l.__decorate([Object(p.f)(m),_()],j),u=a(41),f=a(128),v=a(32),y=a(37);class O extends y.b{constructor(){super(),console.log("LocalStore")}set(e,t){localStorage.setItem(e,JSON.stringify(t))}get(e){let t=localStorage.getItem(e);return JSON.parse(t)}remove(e){localStorage.removeItem(e)}clear(e){localStorage.clear()}link(e){}}class g extends i.b{constructor(){super(...arguments),this.clase="fa-car-side",this.Data=this.properties,this.favorite={preference:{name:"Date",value:Date.now}}}onAttach(){this.Data=this.properties,window.onstorage=(e=>{console.log("The "+e.key+" key has been changed from "+e.oldValue+" to "+e.newValue+".",e),this.Data.name=e.newValue,this.invalidate()});let e=new O;e.set("aaaa.llo","add"),e.set("aaaa.llo.we",{d:10}),console.log(this.Data,this.properties),e.set("aaaa.llo","Prueba"),e.set("aaaa.lloa","TTY&/add"),this.invalidate()}render(){return Object(c.j)("div",{classes:r.container},[Object(c.j)("div",{classes:[r.column]},[Object(c.j)("div",{onclick:e=>{console.log(e),this.Data.color="prueba",this.invalidate()}},[Object(c.k)(b,{},[Object(c.k)(u.a,{label:this.Data.name||this.Data.license_plate+" - "+this.Data.vin,classes:[this.clase,"far",r.title],ShowLabel:!0,onClick:()=>{this.clase="fa-star",console.log("Se ha presionado",this.Data),this.favorite.preference={name:"last_vehicle_selected",value:this.Data.idvehicle},this.invalidate()}}),Object(c.j)("div",{},[Object(c.j)("img",{classes:[r.image]},[]),Object(c.j)("div",{},[Object(c.j)("div",{},[Object(c.j)("div",{},[Object(c.j)("span",{classes:[r.label]},["VIN: "]),Object(c.j)("span",{},[this.Data.vin])]),Object(c.j)("div",{},[Object(c.j)("span",{classes:[r.label]},["AÃ±o: "]),Object(c.j)("span",{},[this.Data.year])]),Object(c.j)("div",{},[Object(c.j)("span",{classes:[r.label]},["Propietario: "]),Object(c.j)("span",{},[this.Data.lfname])]),Object(c.j)("div",{},[Object(c.j)("span",{classes:[r.label]},["Tipo combustible: "]),Object(c.j)("span",{},[this.Data.fueltype])]),Object(c.j)("div",{},[Object(c.j)("span",{},["Color: "]),Object(c.j)("span",{},[this.Data.color])])])]),Object(c.j)("div",{onclick:()=>{this.Data.color="Verde",console.log("Invalida"),this.invalidate()}},["Piecito",Object(c.k)(f.a,this.favorite)])])])])])])}}Object(o.a)([Object(v.a)()],g.prototype,"Data",void 0),a.d(t,"default",function(){return S});class S extends i.b{constructor(){super(...arguments),this.Vehicles=[],this.TextSearch=""}async GetVehicles(){this.Vehicles.push(Object(c.k)(g,{idvehicle:"",name:"name",color:"color",lfname:"element.lfname",fueltype:"element.fueltype",license_plate:"element.license_plate",vin:"element.vin",year:"element.year",fuel_tank_capacity:"element.fuel_tank_capacity"}));try{const e=await fetch("/vehicles",{method:"POST",body:JSON.stringify({idaccount:localStorage.getItem("idaccount"),Search:this.TextSearch}),headers:{"Content-Type":"application/json"}});if(200==e.status){this.Vehicles=[];let t=await e.json();console.log(t),Array.isArray(t)&&t.forEach((e,t)=>{console.log(e.license_plate),this.Vehicles.push(Object(c.k)(g,{idvehicle:e.idvehicle,name:e.name,color:e.color,lfname:e.lfname,fueltype:e.fueltype,license_plate:e.license_plate,vin:e.vin,year:e.year,fuel_tank_capacity:e.fuel_tank_capacity})),this.invalidate()}),this.invalidate()}}catch(e){console.log(e)}}render(){return Object(c.j)("div",{},[Object(c.k)(n.a,{}),Object(c.k)(s.a,{label:"Buscar",value:this.TextSearch,onChange:e=>{console.log(JSON.stringify(e)),this.TextSearch=e,this.Vehicles.push("Pude cambiar"),this.invalidate(),this.GetVehicles().then(()=>{console.log("invalida al terminar de obtener los vehiculos"),this.invalidate()})}},[]),Object(c.j)("div",{},this.Vehicles)])}}}}]);
//# sourceMappingURL=7.acfa5fbec0d2e0a82be6.bundle.js.map