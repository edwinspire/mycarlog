/*!
 * 
 * [Dojo](https://dojo.io/)
 * Copyright [JS Foundation](https://js.foundation/) & contributors
 * [New BSD license](https://github.com/dojo/meta/blob/master/LICENSE)
 * All rights reserved
 * 
 */
(window.dojoWebpackJsonppen_onitoring_ystem=window.dojoWebpackJsonppen_onitoring_ystem||[]).push([[7],{128:function(e,t,a){"use strict";a.d(t,"a",function(){return h});var i=a(33),s=a(18),c=a(19),o=a(22),r=a(23),n=a(32),l=a(40);class h extends c.b{constructor(){super(),this._openSnack=!1,this._MsgSnackBar="",this.SnackBarType="error",Object(r.b)("preference",o.a,this.diffFooReaction)(this)}getLocalUser(){var e={};try{let t=localStorage.getItem("user");if(t){let a=JSON.parse(t);a&&(e=a)}}catch(e){console.error(e)}return console.log(e),e}diffFooReaction(e,t){console.log(t);try{let e=this.getLocalUser();switch(t.preference.name){case"default_idvehicle":e.default_idvehicle=t.preference.value;break;default:if(e&&e.preferences){let a=e.preferences;a[t.preference.name]!=t.preference.value?(a[t.preference.name]=t.preference.value,e.preferences=a,localStorage.setItem("user",JSON.stringify(e)),this.Save()):console.log("No ha cambiado la preferencia")}else this.openSnack("La preferencia "+t.preference.name+" no existe","error")}}catch(e){console.log(e),this.openSnack(e,"error")}}async Save(){var e=this.getLocalUser();if(e.preferences){let t=await fetch("/preferences_u",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}),a=await t.json();console.log(a),a.iduser&&a.rowkey&&(e.rowkey=a.rowkey,localStorage.setItem("user",JSON.stringify(e)))}}openSnack(e,t){this._openSnack=!0,this._MsgSnackBar=e,this.SnackBarType=t,setTimeout(()=>{this._openSnack=!1},4e3)}render(){return Object(s.k)(l.a,{open:this._openSnack,leading:!1,type:this.SnackBarType,messageRenderer:()=>this._MsgSnackBar})}}Object(i.a)([Object(n.a)()],h.prototype,"_openSnack",void 0),Object(i.a)([Object(n.a)()],h.prototype,"_MsgSnackBar",void 0)},324:function(e,t,a){e.exports={" _key":"OpenMonitoringSystem/VehicleCard",container:"VehicleCard-m__container__309e8d3ggyL",column:"VehicleCard-m__column__309e8d2hzND",row:"VehicleCard-m__row__309e8d1cZVt",label:"VehicleCard-m__label__309e8d3hpgA",title:"VehicleCard-m__title__309e8d1zTDQ",image:"VehicleCard-m__image__309e8d1mXtV"}},326:function(e,t,a){a(327),e.exports={" _key":"@dojo/widgets/card",root:"card-m__root__1zMtM",actions:"card-m__actions__1Z_Hb",actionButtons:"card-m__actionButtons__2SSbU",actionIcons:"card-m__actionIcons__3aObP",primaryAction:"card-m__primaryAction__1zj-J",media:"card-m__media__2jfnD",mediaContent:"card-m__mediaContent__2DMyX",mediaSquare:"card-m__mediaSquare__fDbOX",media16by9:"card-m__media16by9__3qldC",primary:"card-m__primary__r84rj",secondary:"card-m__secondary__2FZlH"}},327:function(e,t,a){},334:function(e,t,a){"use strict";a.r(t);var i=a(18),s=a(19),c=a(31),o=a(49),r=a(33),n=a(324),l=a(20),h=a(50),d=a(141);function p(){return Object(h.b)((e,t)=>{Object(d.a)(function(){this.invalidate()})(e)})}var _=a(21),b=a(326);let j=class extends(Object(_.c)(s.a)){render(){const{actionsRenderer:e}=this.properties,t=e&&e();return Object(i.i)("div",{key:"root",classes:this.theme(b.root)},this.children,t&&Object(i.i)("div",{classes:this.theme(b.actions)},t))}};var m=j=l.__decorate([Object(_.f)(b),p()],j),u=a(41),f=a(128),v=a(32),O=a(37),g=a(58),y=a(45);class S extends O.b{constructor(){super(),this.store=new g.a,this.paths=[]}set(e,t){const{apply:a}=this.store;this.paths.forEach(i=>{i.path==e&&a([Object(y.a)(i,t)],!0)})}save(){localStorage.setItem("mycarlog",JSON.stringify(this.get("root")))}get(e){}remove(e){localStorage.removeItem(e)}clear(e){localStorage.clear()}}class k extends s.b{constructor(){super(...arguments),this.clase="fa-car-side",this.Data=this.properties,this.favorite={preference:{name:"Date",value:Date.now}}}onAttach(){this.Data=this.properties,window.onstorage=(e=>{console.log("The "+e.key+" key has been changed from "+e.oldValue+" to "+e.newValue+".",e),this.Data.name=e.newValue,this.invalidate()});let e=new S;e.set("aaaa.llo","add"),e.set("aaaa.llo.we",{d:10}),console.log(this.Data,this.properties),e.set("aaaa.llo","Prueba"),e.set("aaaa.lloa","TTY&/add"),this.invalidate()}render(){return Object(i.j)("div",{classes:n.container},[Object(i.j)("div",{classes:[n.column]},[Object(i.j)("div",{onclick:e=>{console.log(e),this.Data.color="prueba",this.invalidate()}},[Object(i.k)(m,{},[Object(i.k)(u.a,{label:this.Data.name||this.Data.license_plate+" - "+this.Data.vin,classes:[this.clase,"far",n.title],ShowLabel:!0,onClick:()=>{this.clase="fa-star",console.log("Se ha presionado",this.Data),this.favorite.preference={name:"last_vehicle_selected",value:this.Data.idvehicle},this.invalidate()}}),Object(i.j)("div",{},[Object(i.j)("img",{classes:[n.image]},[]),Object(i.j)("div",{},[Object(i.j)("div",{},[Object(i.j)("div",{},[Object(i.j)("span",{classes:[n.label]},["VIN: "]),Object(i.j)("span",{},[this.Data.vin])]),Object(i.j)("div",{},[Object(i.j)("span",{classes:[n.label]},["AÃ±o: "]),Object(i.j)("span",{},[this.Data.year])]),Object(i.j)("div",{},[Object(i.j)("span",{classes:[n.label]},["Propietario: "]),Object(i.j)("span",{},[this.Data.lfname])]),Object(i.j)("div",{},[Object(i.j)("span",{classes:[n.label]},["Tipo combustible: "]),Object(i.j)("span",{},[this.Data.fueltype])]),Object(i.j)("div",{},[Object(i.j)("span",{},["Color: "]),Object(i.j)("span",{},[this.Data.color])])])]),Object(i.j)("div",{onclick:()=>{this.Data.color="Verde",console.log("Invalida"),this.invalidate()}},["Piecito",Object(i.k)(f.a,this.favorite)])])])])])])}}Object(r.a)([Object(v.a)()],k.prototype,"Data",void 0),a.d(t,"default",function(){return w});class w extends s.b{constructor(){super(...arguments),this.Vehicles=[],this.TextSearch=""}async GetVehicles(){const{path:e}=window.GlobalStore;let t=window.GlobalStore.get(e("root","user","idaccount"));try{const e=await fetch("/vehicles",{method:"POST",body:JSON.stringify({idaccount:t,Search:this.TextSearch}),headers:{"Content-Type":"application/json"}});if(200==e.status){this.Vehicles=[];let t=await e.json();console.log(t),Array.isArray(t)&&t.forEach((e,t)=>{console.log(e.license_plate),this.Vehicles.push(Object(i.k)(k,{idvehicle:e.idvehicle,name:e.name,color:e.color,lfname:e.lfname,fueltype:e.fueltype,license_plate:e.license_plate,vin:e.vin,year:e.year,fuel_tank_capacity:e.fuel_tank_capacity})),this.invalidate()}),this.invalidate()}}catch(e){console.log(e)}}render(){return Object(i.j)("div",{},[Object(i.k)(o.a,{}),Object(i.k)(c.a,{label:"Buscar",value:this.TextSearch,onChange:e=>{console.log(JSON.stringify(e)),this.TextSearch=e,this.Vehicles.push("Pude cambiar"),this.invalidate(),this.GetVehicles().then(()=>{console.log("invalida al terminar de obtener los vehiculos"),this.invalidate()})}},[]),Object(i.j)("div",{},this.Vehicles)])}}}}]);
//# sourceMappingURL=7.3cdb9a4a6a02250ebd29.bundle.js.map