{"version":3,"sources":["webpack://pen_onitoring_ystem/./src/widgets/login/Login.m.css","webpack://pen_onitoring_ystem/./src/widgets/login/Login.ts"],"names":["module","exports"," _key","root","body","wrapper","form-success","container","form","links_block","bg_bubbles","square","Login","_dojo_framework_core_WidgetBase__WEBPACK_IMPORTED_MODULE_2__","[object Object]","this","_openSnack","_MsgSnackBar","msg","console","log","invalidate","setTimeout","document","cookie","Object","_dojo_framework_core_vdom__WEBPACK_IMPORTED_MODULE_1__","classes","_Login_m_css__WEBPACK_IMPORTED_MODULE_3__","action","method","onsubmit","e","target","inputs","getElementsByTagName","i","DataLogin","length","defineProperty","name","value","enumerable","res","fetch","JSON","stringify","headers","Content-Type","data","json","status","login","path","apply","window","GlobalStore","_dojo_framework_stores_state_operations__WEBPACK_IMPORTED_MODULE_6__","idaccount","iduser","preferences","username","fullname","rowkey","location","href","SnackBar","message","preventDefault","type","placeholder","required","_dojo_widgets_snackbar__WEBPACK_IMPORTED_MODULE_4__","open","leading","messageRenderer","tslib__WEBPACK_IMPORTED_MODULE_0__","_dojo_framework_core_decorators_watch__WEBPACK_IMPORTED_MODULE_5__"],"mappings":"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","file":"10.a5b577803df1925ba381.bundle.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\" _key\":\"OpenMonitoringSystem/Login\",\"root\":\"Login-m__root__309e8d3B_u0\",\"body\":\"Login-m__body__309e8d39SBB\",\"wrapper\":\"Login-m__wrapper__309e8d20JBI\",\"form-success\":\"Login-m__form-success__309e8d1TYVx\",\"container\":\"Login-m__container__309e8daargL\",\"form\":\"Login-m__form__309e8d3_nB0\",\"links_block\":\"Login-m__links_block__309e8d173hP\",\"bg_bubbles\":\"Login-m__bg_bubbles__309e8d1X-H3\",\"square\":\"Login-m__square__309e8d3FwE5\"};","import { v, w } from \"@dojo/framework/core/vdom\";\nimport WidgetBase from \"@dojo/framework/core/WidgetBase\";\nimport * as css from \"./Login.m.css\";\nimport SBar from \"@dojo/widgets/snackbar\";\nimport watch from \"@dojo/framework/core/decorators/watch\";\nimport { add } from \"@dojo/framework/stores/state/operations\";\n//import {StateStore} from \"../../main\";\n\nexport default class Login extends WidgetBase {\n  @watch() private _openSnack = false;\n  @watch() private _MsgSnackBar = \"-\";\n\n  private SnackBar(msg: string) {\n    console.log(\"SnackBar \" + msg);\n    this._openSnack = true;\n    this._MsgSnackBar = msg;\n    this.invalidate();\n    setTimeout(() => {\n      this._openSnack = false;\n      this.invalidate();\n    }, 4000);\n  }\n\n  onAttach() {\n    document.cookie = \"TOKEN_USER= ; expires = Thu, 01 Jan 1970 00:00:00 GMT\";\n    console.log(\"Borrar\");\n  }\n\n  protected render() {\n    return v(\"div\", { classes: [css.root] }, [\n      v(\"div\", { classes: [css.body] }, [\n        v(\"div\", { classes: css.wrapper }, [\n          v(\"div\", { classes: [css.container] }, [\n            v(\"h1\", {}, [\"Login\"]),\n            v(\n              \"form\",\n              {\n                classes: css.form,\n                action: \"/login\",\n                method: \"post\",\n                onsubmit: (e: Event) => {\n                  if (e.target) {\n                    let d = e.target as HTMLFormElement;\n                    let inputs = d.getElementsByTagName(\"input\");\n                    let i = 0;\n                    var DataLogin = {};\n\n                    for (i = 0; i < inputs.length; i++) {\n                      Object.defineProperty(DataLogin, inputs[i].name, {\n                        value: inputs[i].value,\n                        enumerable: true,\n                      });\n                      if (i + 1 == inputs.length) {\n                        (async () => {\n                          let res = await fetch(\"/login\", {\n                            method: \"POST\",\n                            body: JSON.stringify(DataLogin),\n                            headers: { \"Content-Type\": \"application/json\" },\n                          });\n                          var data = await res.json();\n                          console.log(data);\n                          if (res.status == 200) {\n                            if (!data.login) {\n                              this.SnackBar(data.message);\n                            } else {\n                              const { path, apply } = window.GlobalStore;\n                              apply(\n                                [\n                                  add(\n                                    path(\"root\", \"user\", \"idaccount\"),\n                                    data.idaccount\n                                  ),\n                                ],\n                                true\n                              );\n                              apply(\n                                [\n                                  add(\n                                    path(\"root\", \"user\", \"iduser\"),\n                                    data.iduser\n                                  ),\n                                ],\n                                true\n                              );\n                              apply(\n                                [\n                                  add(\n                                    path(\"root\", \"user\", \"preferences\"),\n                                    data.preferences\n                                  ),\n                                ],\n                                true\n                              );\n                              apply(\n                                [\n                                  add(\n                                    path(\"root\", \"user\", \"username\"),\n                                    data.username\n                                  ),\n                                ],\n                                true\n                              );\n                              apply(\n                                [\n                                  add(\n                                    path(\"root\", \"user\", \"fullname\"),\n                                    data.fullname\n                                  ),\n                                ],\n                                true\n                              );\n                              apply(\n                                [\n                                  add(\n                                    path(\"root\", \"user\", \"rowkey\"),\n                                    data.rowkey\n                                  ),\n                                ],\n                                true\n                              );\n\n                              window.location.href = \"/#home\";\n                            }\n                          } else {\n                            this.SnackBar(\n                              \"Sucedi√≥ un inconveniente con el servidor\"\n                            );\n                          }\n                        })();\n                      }\n                    }\n                  }\n\n                  e.preventDefault();\n                },\n              },\n              [\n                //v('input', {classes: [css.input], name: 'account',  type: 'text', placeholder: 'Cuenta'}, []),\n                v(\n                  \"input\",\n                  {\n                    name: \"username\",\n                    type: \"text\",\n                    placeholder: \"Usuario\",\n                    required: \"required\",\n                  },\n                  []\n                ),\n                v(\n                  \"input\",\n                  {\n                    name: \"pwd\",\n                    type: \"password\",\n                    placeholder: \"Contrase√±a\",\n                    required: \"required\",\n                  },\n                  []\n                ),\n                v(\"input\", { type: \"submit\", name: \"submit\", value: \"Aceptar\" }),\n                v(\"div\", { classes: css.links_block }, [\n                  v(\"a\", { href: \"/#register\" }, [\"Registro\"]),\n                ]),\n              ]\n            ),\n          ]),\n          w(SBar, {\n            open: this._openSnack,\n            leading: false,\n            type: \"error\",\n            messageRenderer: () => this._MsgSnackBar,\n          }),\n        ]),\n      ]),\n      v(\"ul\", { classes: css.bg_bubbles }, [\n        v(\"li\"),\n        v(\"li\"),\n        v(\"li\"),\n        v(\"li\"),\n        v(\"li\"),\n        v(\"li\"),\n        v(\"li\"),\n        v(\"li\"),\n        v(\"li\"),\n        v(\"li\"),\n      ]),\n    ]);\n  }\n}\n"],"sourceRoot":""}